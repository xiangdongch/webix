/*
@license
Webix SpreadSheet v.3.4.0
This software is covered by Webix Commercial License.
Usage without proper license is prohibited.
(c) XB Software Ltd.
*/
!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="/codebase/",t(0)}([function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}n(1),n(2);var r=n(9),i=o(r),a=n(10),s=o(a),l=n(11),u=o(l),c=n(22),f=o(c),d=n(23),h=o(d),v=n(24),p=o(v),w=n(25),g=o(w),m=n(26),b=o(m);n(29),webix.protoUI({name:"spreadsheet",_base_index:{count:1},defaults:{spans:!0,rowCount:50,columnCount:20,columnOperation:!1},$init:function(e){this.$index=this._base_index.count++,this.$view.className+=" webix_ssheet",this.$ready.unshift(this._sub_init),this.$ready.push(this._set_handlers)},formatHelpers:{price:function(e){return webix.i18n.priceFormat(e)},"int":function(e){return webix.i18n.numberFormat(e)},percent:function(e){return Math.round(100*e)+"%"}},_sub_init:function(){var e=this.config,t=[];e.readonly&&e.toolbar!==!1||t.push(i.init(this)),e.subbar&&t.push(e.subbar),e.liveEditor&&t.push(b.init(this)),t.push(u.init(this,{editable:!e.readonly,spans:!0,clipboard:e.clipboard})),this.rows_setter(t)},_set_handlers:function(){var e=this;this._table||(u.reset(this,this.config.columnCount,this.config.rowCount),s.init(this),f.init(this),h.init(this),g.init(this),this._table=this.$$("cells"),this._table.attachEvent("onAfterAreaAdd",function(){return e.callEvent("onAfterSelect",[e.getSelectedId(!0)])}),this.callEvent("onComponentInit",[]),p.init(this))},$onLoad:function(e,t){if(this._set_handlers(),e.excel){var n=e.options||{};n.math=this.config.math,e=t.getSheet(e,n),e=this._excel_to_data(e)}var o=Math.max(this.config.rowCount,e.data.length),r=e.data[0]?Math.max(this.config.columnCount,e.data[0].length):this.config.columnCount;o==this.config.rowCount&&r==this.config.columnCount||(this.config.rowCount=o,this.config.columnCount=r,u.reset(this)),this.callEvent("onDataParse",[e]),this._table.refresh()},serialize:function(e){var t={};return this.callEvent("onDataSerialize",[t,e]),t},_excel_to_data:function(e){for(var t=webix.copy(e.data||e),n=[],o=0;o<t.length;o++)for(var r=0;r<t[0].length;r++){var i=o+1,a=r+1;n.push([i,a,t[o][r]])}if(e.spans)for(var o=0;o<e.spans.length;o++)e.spans[o][0]++,e.spans[o][1]++;return e.data?e.data=n:e={data:n},e},refresh:function(e){e?this._table.refreshColumns():this._table.refresh()},eachSelectedCell:function(e){for(var t=this.getSelectedId(!0),n=0;n<t.length;n++)e.call(this,t[n])},getSelectedId:function(e){var t=this._table.getSelectArea();if(!e)return t&&t.start.row?t.start:null;var n=[];if(t)for(var o=t.start,r=t.end,i=o.row;i<=r.row;i++)for(var a=o.column;a<=r.column;a++)n.push({row:i,column:a});return n},getCellValue:function(e,t){var n=this.getRow(e);return n["$"+t]||n[t]},setCellValue:function(e,t,n){var o=this.getRow(e);o[t]=n,delete o["$"+t],this.callEvent("onCellChange",[e,t,n,!0]),this.saveCell(e,t)},$exportView:function(e){return webix.extend(e,{header:!1,rawValues:!0,spans:!0,xCorrection:1,yCorrection:1}),this._table},getRow:function(e){return this._table.getItem(e)},getColumn:function(e){return this._table.getColumnConfig(e)},getStyle:function(e,t){return s.getStyle(this,{row:e,column:t})},setStyle:function(e,t,n){return s.setStyle(this,{row:e,column:t},n)},combineCells:function(e){if(!e){var t=this.getSelectedId(!0);t.length>1&&(e=p.getRange(t))}e&&this.callEvent("onBeforeSpan",[e.cell.row,e.cell.column,[e.x,e.y]])&&p.addSpan(this,e.cell,e.x,e.y),this.refresh()},splitCell:function(e,t){if(e&&t)p.removeSpan(this,{row:e,column:t});else{var n=webix.uid();this.eachSelectedCell(function(e){var t=this._table.getSpan(e.row,e.column);t&&this.callEvent("onBeforeSplit",[e.row,e.column,[t[2],t[3]],n])&&p.removeSpan(this,e)})}this.refresh()},_save:function(e,t){var n=this.config.save,o="";"string"==typeof n?o=n+"/"+e:n&&n[e]&&(o=n[e]),o&&(o.$proxy&&o.save?o.save(this,t,null,null):webix.ajax().post(o,t))},saveCell:function(e,t){var n=this.getStyle(e,t);this._save("data",{row:e,column:t,value:this.getCellValue(e,t),style:n?n.id:""})},reset:function(e){this.callEvent("onReset",[e])},undo:function(){g.undo(this)},redo:function(){g.redo(this)}},webix.AtomDataLoader,webix.IdSpace,webix.ui.layout)},function(e,t){"use strict";webix.i18n.spreadsheet={labels:{common:"Common",currency:"Currency",number:"Number",percent:"Percent",undo:"Undo/Redo",font:"Font",text:"Text",cell:"Cell",align:"Align",format:"Format",column:"Column",px:"px"},tooltips:{color:"Font color",background:"Background color","font-family":"Font family","font-size":"Font size","text-align":"Horizontal align","vertical-align":"Vertical align",borders:"Borders","borders-no":"Clear borders","borders-left":"Left border","borders-top":"Top border","borders-right":"Right border","borders-bottom":"Bottom border","borders-all":"All borders","borders-outer":"Outer borders","borders-top-bottom":"Top and bottom borders","borders-color":"Border color","align-left":"Left align","align-center":"Center align","align-right":"Right align","align-top":"Top align","align-middle":"Middle align","align-bottom":"Bottom align",span:"Merge",wrap:"Text wrap",undo:"Undo",redo:"Redo",format:"Format","font-weight":"Bold","font-style":"Italic","text-decoration":"Underline"},menus:{add_row:"Insert Row",del_row:"Delete Row",show_row:"Show Row",hide_row:"Hide Row",add_column:"Insert Column",del_column:"Delete Column",show_column:"Show Column",hide_column:"Hide Column"}}},function(e,t,n){"use strict";n(3),n(4),n(5),n(6),n(7),n(8)},function(e,t){"use strict";webix.protoUI({name:"ssheet-borders-suggest",defaults:{width:300},$init:function(e){e.body={margin:6,cols:[{view:"dataview",css:"webix_ssheet_dataview",borderless:!0,scroll:!1,select:!0,xCount:4,yCount:2,on:{onAfterSelect:function(e){var t=this.getParentView().getParentView();t.updateMasterValue(!0)}},type:{width:36,height:36,template:function(e){var t="webix_ssheet_button_icon webix_ssheet_icon_borders_"+e.value,n=webix.i18n.spreadsheet.tooltips["borders-"+e.id];return"<div title='"+n+"'><span class='"+t+"'></span></div>"}},data:e.data},{view:"ssheet-separator"},{rows:[{view:"ssheet-colorpicker",css:e.css,name:e.name,width:62,tooltip:webix.i18n.spreadsheet.tooltips["borders-color"],title:"<span class='webix_icon fa-pencil'></span>",on:{onChange:function(){var e=this.getParentView().getParentView().getParentView();e.updateMasterValue(!1)}}},{}]}]}},updateMasterValue:function(e){var t=this.getValue(),n=webix.$$(this.config.master);n.setValue(t),e&&this.hide()},setValue:function(e){e[0]&&this.getList().select(e[0]),e[1]&&this.getColorView().setValue(e[1])},getValue:function(){return[this.getList().getSelectedId(),this.getColorView().getValue()||""]},getList:function(){return this.getBody().getChildViews()[0]},getColorView:function(){return this.getBody().getChildViews()[2].getChildViews()[0]}},webix.ui.suggest),webix.protoUI({name:"ssheet-borders",$cssName:"richselect",defaults:{text:"<span class='webix_ssheet_button_icon webix_ssheet_icon_borders'>"},$init:function(e){e.options={view:"ssheet-borders-suggest",fitMaster:!1,data:e.data},this.$ready.push(webix.bind(function(){this.getPopup().config.master=this.config.id},this))},setValue:function(e){return webix.isArray(e)&&(this.config.value&&e[0]==this.config.value[0]&&e[1]==this.config.value[1]||this.getPopup().setValue(e),this.config.value=e,e[0]&&this.callEvent("onChange")),e},getValue:function(){return this.getPopup().getValue().join(",")},getList:function(){return this.getPopup().getBody().getChildViews()[0]},getColorView:function(){return this.getPopup().getBody().getChildViews()[1].getChildViews()[0]}},webix.ui.richselect)},function(e,t){"use strict";webix.protoUI({$cssName:"colorboard",name:"ssheet-colorboard",setValue:function(e){return e?("#"!=e.charAt(0)&&(e="#"+e),this.config.value=e,this.drawSelection(e),e):void 0},drawSelection:function(e,t){if(this.isVisible(this.config.id))for(var n=this.$view.lastChild.getElementsByTagName("DIV"),o=0;o<n.length;o++){var r=n[o].getAttribute("webix_val");r&&(r.toUpperCase()!=e.toUpperCase()?webix.html.removeCss(n[o],"webix_selected"):webix.html.addCss(n[o],"webix_selected",""))}}},webix.ui.colorboard),webix.protoUI({$cssName:"richselect",name:"ssheet-colorpicker",defaults:{css:"webix_ssheet_colorpicker",icon:"angle-down",suggest:{height:202,borderless:!0,body:{view:"ssheet-colorboard",css:"webix_ssheet_colorboard",palette:[["#000000","#434343","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#f3f3f3","#ffffff"],["#980000","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#4a86e8","#0000ff","#9900ff","#ff00ff"],["#e6b8af","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#c9daf8","#cfe2f3","#d9d2e9","#ead1dc"],["#dd7e6b","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#a4c2f4","#9fc5e8","#b4a7d6","#d5a6bd"],["#cc4125","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6d9eeb","#6fa8dc","#8e7cc3","#c27ba0"],["#a61c00","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3c78d8","#3d85c6","#674ea7","#a64d79"],["#85200c","#990000","#b45f06","#bf9000","#38761d","#134f5c","#1155cc","#0b5394","#351c75","#741b47"],["#5b0f00","#660000","#783f04","#7f6000","#274e13","#0c343d","#1c4587","#073763","#20124d","#4c1130"]],on:{onSelect:function(e){this.getParentView().setMasterValue({value:e})}}}}},$init:function(){this.$view.className+=" webix_ssheet_colorpicker"},$renderInput:function(e,t,n){var o=this.renderColor.call(this);return t=t.replace(/([^>]>)(.*)(<\/div)/,function(t,n,r,i){return n+e.title+o+i}),webix.ui.colorpicker.prototype.$renderInput.call(this,e,t,n)},$setValue:function(e){var t=webix.$$(this.config.popup.toString()),n=t.getBody();e&&(n.setValue(e),this.config.value=e,this.getColorNode().style.backgroundColor=e)},renderColor:function(){return"<div class='webix_ssheet_cp_color' style='background-color:"+this.config.value+";'> </div>"},getColorNode:function(){return this.$view.firstChild.firstChild.childNodes[1]},$renderIcon:function(){return webix.ui.richselect.prototype.$renderIcon.apply(this,arguments)}},webix.ui.colorpicker)},function(e,t){"use strict";webix.protoUI({name:"ssheet-align",$cssName:"richselect",$init:function(e){e.options={view:"datasuggest",css:"webix_ssheet_dataview",body:{borderless:!0,tooltip:{template:"#tooltip#"},xCount:3,yCount:1,type:{width:36,height:36}},data:e.data}}},webix.ui.richselect)},function(e,t){"use strict";webix.protoUI({$cssName:"toggle",name:"ssheet-toggle",toggle:function(){var e=this.getValue()==this.config.onValue;this.setValue(!e)},getValue:function(){var e=this.config,t=e.value;return t?e.onValue||!0:e.offValue||!1},defaults:{template:function(e,t){var n=e.value===!0||e.value==e.onValue?" webix_pressed":"",o=t.$renderInput(e,t);return"<div class='webix_el_box"+n+"' style='width:"+e.awidth+"px; height:"+e.aheight+"px'>"+o+"</div>"}}},webix.ui.toggle)},function(e,t){"use strict";webix.protoUI({name:"ssheet-separator",defaults:{css:"webix_ssheet_toolbar_spacer",template:" ",width:1,borderless:!0}},webix.ui.view)},function(e,t){"use strict";webix.protoUI({name:"ssheet-column",$cssName:"richselect",defaults:{command:!0,width:70,text:"<span class='webix_ssheet_button_icon webix_ssheet_icon_borders'>"},$init:function(e){e.options={fitMaster:!1,body:{view:"list",on:{onItemClick:function(e){var t=this.getTopParentView();t.callEvent("onCommand",[e,null])}},css:"webix_ssheet_column__selected",data:e.data,width:150}}},$setValue:function(){return""}},webix.ui.richselect)},function(e,t){"use strict";function n(){return[{id:"-1",value:webix.i18n.spreadsheet.labels.common},{id:"price",value:webix.i18n.spreadsheet.labels.currency,example:"98.20"},{id:"int",value:webix.i18n.spreadsheet.labels.number,example:"2120.02"},{id:"percent",value:webix.i18n.spreadsheet.labels.percent,example:"0.5"}]}function o(){return[{id:"add_row",value:webix.i18n.spreadsheet.menus.add_row},{id:"del_row",value:webix.i18n.spreadsheet.menus.del_row},{id:"show_row",value:webix.i18n.spreadsheet.menus.show_row},{id:"hide_row",value:webix.i18n.spreadsheet.menus.hide_row},{id:"add_column",value:webix.i18n.spreadsheet.menus.add_column},{id:"del_column",value:webix.i18n.spreadsheet.menus.del_column},{id:"show_column",value:webix.i18n.spreadsheet.menus.show_column},{id:"hide_column",value:webix.i18n.spreadsheet.menus.hide_column}]}function r(){for(var e=["8","9","10","11","12","14","15","16","18","20","22","24","28","36"],t=[],n=0;n<e.length;n++)t.push({id:e[n]+webix.i18n.spreadsheet.labels.px,value:e[n]});return t}function i(e,t){var n,o,r=t.start,i=t.end;for(n=1*r.row;n<=1*i.row;n++)for(o=1*r.column;o<=1*i.column;o++)if(e.$$("cells").getSpan(n,o))return!0;return!1}function a(e){e.attachEvent("onComponentInit",function(){return s(e)});var t={view:"toolbar",css:"webix_ssheet_toolbar webix_layout_toolbar",id:"bar",padding:0,elements:p.toolbarElements(e,e.config.buttons||v),on:{onChange:function(){var t=this.$eventSource,n=t.getValue(),o=t.config.name;e.callEvent("onStyleSet",[o,n])},onItemClick:function(t){var n=e.innerId(t);w[n]&&w[n].call(this,e)}}};return e.callEvent("onViewInit",["toolbar",t]),t}function s(e){e.attachEvent("onAfterSelect",function(t){return l(e,t)})}function l(e,t){var n={},o=t[0];if(o){var r=e.getStyle(o.row,o.column);r&&(n=r.props)}webix.extend(n,c),e.$$("bar").setValues(n)}t.__esModule=!0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t.init=a;var c={color:"#000000",background:"#ffffff","font-family":"'PT Sans', Tahoma","font-size":"15px","text-align":"left","vertical-align":"top","white-space":"nowrap",borders:["no","#434343"]},f=[{id:"Arial",value:"Arial"},{id:"'PT Sans', Tahoma",value:"PT Sans"},{id:"Tahoma",value:"Tahoma"},{id:"Verdana",value:"Verdana"}],d=[{id:"no",value:"no"},{id:"left",value:"left"},{id:"top",value:"top"},{id:"right",value:"right"},{id:"bottom",value:"bottom"},{id:"all",value:"all"},{id:"outer",value:"outer"},{id:"top-bottom",value:"top_bottom"}],h={height:39,margin:7,paddingY:1,sectorPadding:5,sectorMargin:0},v={undo:["undo","redo"],font:["font-family","font-size"],text:["font-weight","font-style","text-decoration","color"],cell:["background","borders","span"],align:["text-align","vertical-align","wrap"],format:["format"]},p={toolbarElements:function(e,t){var n=[];for(var o in t)n.push(p.elementsBlock(e,o,t[o])),n.push(p.separator());return n},elementsBlock:function(e,t,n){var o={rows:[{padding:2,cols:[{height:h.height,margin:2,cols:p.blockColumns(e,n)}]},p.title({title:t})]};return o},blockColumns:function(e,t){for(var n=[],o=0;o<t.length;o++)"object"==u(t[o])?n.push(t[o]):g[t[o]]&&n.push(g[t[o]](e));return n},button:function(e){return{view:"ssheet-toggle",width:e.width||40,id:e.name,name:e.name,label:e.label,css:e.css||"",onValue:e.onValue,offValue:e.offValue,tooltip:webix.i18n.spreadsheet.tooltips[e.name]||""}},colorButton:function(e){return{view:"ssheet-colorpicker",css:e.css,name:e.name,width:e.width||62,title:"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon_"+e.name+"' ></span>",tooltip:webix.i18n.spreadsheet.tooltips[e.name]||""}},iconButton:function(e){var t=webix.copy(e);return webix.extend(t,{view:"button",type:"htmlbutton",width:40,id:e.name,label:"<span class='webix_ssheet_button_icon webix_ssheet_icon_"+e.name+"'></span>",css:"",tooltip:webix.i18n.spreadsheet.tooltips[e.name]||""}),e.onValue&&webix.extend(t,{view:"ssheet-toggle",onValue:e.onValue,offValue:e.offValue},!0),t},segmented:function(e){return{view:"segmented",name:e.name,css:e.css||"",width:e.width||115,options:e.options}},select:function(e){return webix.extend(e,{view:"richselect",id:e.name,value:c[e.name],suggest:{css:"webix_ssheet_suggest",fitMaster:!1,padding:0,data:e.options}}),e.tooltip=webix.i18n.spreadsheet.tooltips[e.name]||"",e.suggest.width=e.popupWidth||e.width,e.popupTemplate&&(e.suggest.body={template:e.popupTemplate}),e},separator:function(){return{view:"ssheet-separator"}},title:function m(e){var m=e.title;return 0===m.indexOf("$")&&(m=""),m=webix.i18n.spreadsheet.labels[e.title]||m,{template:m,height:e.height||24,css:"webix_ssheet_subbar_title",borderless:!0}},borders:function(e){return{view:"ssheet-borders",width:e.width||62,data:d,id:e.name,name:e.name,tooltip:webix.i18n.spreadsheet.tooltips[e.name]}},align:function(e){return{view:"ssheet-align",value:c[e.name],width:e.width||62,data:e.options,name:e.name,tooltip:webix.i18n.spreadsheet.tooltips[e.name]}},column:function(e){return{view:"ssheet-column",data:e.data,id:e.name,name:e.name}}},w={span:function(e){var t=e.$$("cells").getSelectArea();t&&(i(e,t)?e.splitCell():e.combineCells())},undo:function(e){e.undo()},redo:function(e){e.redo()}},g={undo:function(){return p.iconButton({name:"undo"})},redo:function(){return p.iconButton({name:"redo"})},"font-family":function(){return p.select({name:"font-family",tooltip:"Font family",options:f,width:100})},"font-size":function(){return p.select({name:"font-size",tooltip:"Font size",options:r(),width:62})},"font-weight":function(){return p.button({name:"font-weight",label:"B",css:"webix_ssheet_bold",tooltip:"Bold",onValue:"bold",offValue:"normal"})},"font-style":function(){return p.button({name:"font-style",label:"I",css:"webix_ssheet_italic",tooltip:"Italic",onValue:"italic",offValue:"normal"})},"text-decoration":function(){return p.button({name:"text-decoration",label:"U",css:"webix_ssheet_underline",tooltip:"Underline",onValue:"underline",offValue:"normal"})},color:function(){return p.colorButton({name:"color",icon:"font",css:"webix_ssheet_color"})},background:function(){return p.colorButton({name:"background",icon:"paint-brush",css:"webix_ssheet_background"})},borders:function(){return p.borders({name:"borders"})},span:function(){return p.iconButton({name:"span"})},"text-align":function(){var e=webix.i18n.spreadsheet.tooltips;return p.align({name:"text-align",tooltip:"Horizontal Align",css:"webix_ssheet_align",options:[{id:"left",value:"<span class='webix_ssheet_button_icon webix_ssheet_icon_left'></span>",tooltip:e["align-left"]},{id:"center",value:"<span class='webix_ssheet_button_icon webix_ssheet_icon_center' ></span>",tooltip:e["align-center"]},{id:"right",value:"<span class='webix_ssheet_button_icon webix_ssheet_icon_right' ></span>",tooltip:e["align-right"]}]})},"vertical-align":function(){var e=webix.i18n.spreadsheet.tooltips;return p.align({name:"vertical-align",tooltip:"Vertical Align",css:"webix_ssheet_align",options:[{id:"top",value:"<span class='webix_ssheet_button_icon webix_ssheet_icon_top' ></span>",tooltip:e["align-top"]},{id:"middle",value:"<span class='webix_ssheet_button_icon webix_ssheet_icon_middle'></span>",tooltip:e["align-middle"]},{id:"bottom",value:"<span class='webix_ssheet_button_icon webix_ssheet_icon_bottom'></span>",tooltip:e["align-bottom"]}]})},wrap:function(){return p.iconButton({name:"wrap",onValue:"wrap",offValue:"nowrap"})},format:function(e){return p.select({name:"format",tooltip:"Cell data format",options:n(),width:100,popupWidth:150,popupTemplate:function(t){var n=e.formatHelpers[t.id];return t.value+(n?"<span class='webix_ssheet_right'>"+n(t.example)+"</span>":"")}})},column:function(e){return p.column({data:o()})}}},function(e,t){"use strict";function n(e){e.attachEvent("onStyleSet",function(t,n){return l(e,t,n)}),e.attachEvent("onDataParse",function(t){return s(e,t)}),e.attachEvent("onDataSerialize",function(t){return a(e,t)}),e.attachEvent("onReset",function(t,n){return o(e)}),e.attachEvent("onUndo",function(t,n,o,r){"style"==t&&i(e,n,o,r)}),o(e)}function o(e){e._styles={},e._styles_cache={},e._styles_max=0}function r(e,t){var n=e.getRow(t.row).$cellCss;if(n){var o=n[t.column];if(o)return e._styles[o]}return null}function i(e,t,n,o){var i={row:t,column:n};d(e,i,o);var a=r(e,i);e.callEvent("onStyleChange",[t,n,o,a]),e.refresh()}function a(e,t){var n=[];for(var o in e._styles_cache)n.push([e._styles_cache[o].id,o]);t.styles=n}function s(e,t){if(t.styles)for(var n=0;n<t.styles.length;n++){var o=t.styles[n],r={id:o[0],text:o[1],props:p(o[1])};h(e,r,!0),e._styles[r.id]=r}for(var n=0;n<t.data.length;n++){var i=t.data[n],a=i[0],s=i[1],l=(i[2],i[3]);l&&f(e.getRow(a),s,e._styles[l])}}function l(e,t,n){var o=webix.uid();e.eachSelectedCell(function(r){u(e,r,t,n,o)}),e.refresh()}function u(e,t,n,o,i){var a=r(e,t),s=c(e,a,n,o,t);s&&s!=a&&e.callEvent("onBeforeStyleChange",[t.row,t.column,s,a,i])&&(d(e,t,s),e.callEvent("onStyleChange",[t.row,t.column,s,a,i]))}function c(e,t,n,o,r){if(b[n])return b[n](e,t,o,r);if(t&&t.props[n]==o)return t;var i={text:"",id:0,props:t?webix.copy(t.props):{}};i.props[n]=o,i.text=v(i);var a=e._styles_cache[i.text];return a?a:(h(e,i),i)}function f(e,t,n){e.$cellCss=e.$cellCss||{},e.$cellFormat=e.$cellFormat||{},n?(e.$cellCss[t]=n.id,e.$cellFormat[t]=n.props.format||null):(delete e.$cellCss[t],delete e.$cellFormat[t])}function d(e,t,n){n&&(e._styles[n.id]=n),f(e.getRow(t.row),t.column,n),e.saveCell(t.row,t.column)}function h(e,t,n){e._styles_max++,e._styles_cache[t.text]=t,t.id=t.id||"wss"+e._styles_max;var o="";for(var r in t.props)t.props[r]&&(g[r]?g[r][t.props[r]]?o+=g[r][t.props[r]](t.props):"function"==typeof g[r]&&(o+=g[r](t.props)):o+=r+":"+t.props[r]+";");webix.html.addStyle(".wss_"+e.$index+" ."+t.id+"{"+o+"}"),n||e._save("styles",{name:t.id,text:t.text})}function v(e){for(var t=[],n=0;n<w.length;n++)t.push(e.props[w[n]]);return t.join(";")}function p(e){for(var t=e.split(";"),n={},o=0;o<w.length;o++)n[w[o]]=t[o];return n}t.__esModule=!0,t.init=n,t.getStyle=r,t.setStyle=d;var w=["color","background","text-align","font-family","font-size","font-style","text-decoration","font-weight","vertical-align","wrap","borders","format","border-right","border-bottom","border-left","border-top"],g={"vertical-align":{top:function(e){return"display: block;"},middle:function(e){var t="flex-start";"center"==e["text-align"]?t="center":"right"==e["text-align"]&&(t="flex-end");var n="display: flex; align-items: center;justify-content:"+t+";";return n},bottom:function(e){var t="flex-start";"center"==e["text-align"]?t="center":"right"==e["text-align"]&&(t="flex-end");var n="display: flex; align-items:flex-end;justify-content:"+t+";";return n}},wrap:{wrap:function(e){return"white-space: normal !important;"},nowrap:function(e){return""}},format:"",borders:"","border-left":function(e){return e["border-left"]?"border-left: 1px solid "+e["border-left"]+" !important;":""},"border-top":function(e){return e["border-top"]?"border-top: 1px solid "+e["border-top"]+" !important;":""},"border-right":function(e){return e["border-right"]?"border-right-color: "+e["border-right"]+" !important;":""},"border-bottom":function(e){return e["border-bottom"]?"border-bottom-color: "+e["border-bottom"]+" !important;":""}},m={"border-left":function(e,t,n){return e.column==t.start.column},"border-right":function(e,t,n){return e.column==t.end.column||"all"==n||"no"==n},"border-top":function(e,t,n){return e.row==t.start.row},"border-bottom":function(e,t,n){return e.row==t.end.row||"all"==n||"no"==n}},b={borders:function(e,t,n,o){var r=e.$$("cells").getSelectArea();n=n.split(",");var i=n[0],a=n[1],s=["border-left","border-right","border-bottom","border-top"];"no"==i?a="":"top-bottom"==i?s=["border-top","border-bottom"]:"all"!=i&&"outer"!=i&&(s=["border-"+i]);for(var l=0;l<s.length;l++){var u=s[l];m[u](o,r,i)&&(t=c(e,t,u,a,o))}return t}}},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){e.attachEvent("onComponentInit",function(){return i(e)});var n={view:"datatable",id:"cells",css:"webix_ssheet_table wss_"+e.$index,headerRowHeight:20,spans:!0,leftSplit:1,areaselect:!0,editable:!0,editaction:"dblclick",navigation:!0};return"undefined"==typeof t.clipboard&&(t.clipboard=!0),t&&(n=webix.extend(n,t,!0)),n}function i(e){var t=e.$$("cells");e.config.math&&(d.init(e),t.config.editMath=!0),e.config.columnOperation&&(w.init(e),t.on_context.sheet_column_0=function(e,t,n){var o=webix.html.pos(e);webix.$$("rows_context_menu").show(o,t.row,"row"),webix.html.preventEvent(e)},t.on_context.webix_hcell=function(e,t,n){var o=webix.html.pos(e);webix.$$("rows_context_menu").show(o,t.column,"column"),webix.html.preventEvent(e)}),t.attachEvent("onAfterEditStop",function(t,n){t.old===webix.undefined&&""===t.value||t.value!=t.old&&e.callEvent("onBeforeValueChange",[n.row,n.column,t.value,t.old])&&e.setCellValue(n.row,n.column,t.value)}),t.config.clipboard&&v.init(e,t.config.readonly),e.attachEvent("onDataParse",function(t){return s(e,t)}),e.attachEvent("onDataSerialize",function(t,n){return a(e,t,n)}),t.attachEvent("onBeforeSelect",function(e){return"rowId"!=e.column}),t.attachEvent("onBeforeBlockSelect",function(e,t){"rowId"===e.column&&(e.column=1),"rowId"===t.column&&(t.column=1)}),t.attachEvent("onItemClick",function(t,n){return"rowId"==t.column?w.selectRow(t.row,e):!0}),t.attachEvent("onHeaderClick",function(t,n){return w.selectColumn(t.column,e)}),e.attachEvent("onReset",function(t){return u(e,t)}),e.attachEvent("onUndo",function(t,n,o,r){"value"==t&&c(e,n,o,r)}),t.attachEvent("onBlur",function(){webix.delay(function(){var n=document.activeElement;if(!n||"INPUT"!=n.tagName){var o=webix.UIManager.getFocus();o&&o!=t&&o.getTopParentView&&o.getTopParentView()===e&&webix.UIManager.setFocus(t)}},this,[],100)})}function a(e,t,n){var o=n&&n.math,r=[],i=e.$$("cells"),a=i.getState(),s=a.ids.concat(a.hidden);i.eachRow(function(e){for(var t=this.getItem(e),n=1;n<s.length;n++){var i=s[n],a=t[i],l=t.$cellCss?t.$cellCss[i]||"":"";(""!==a&&"undefined"!=typeof a||l)&&(o&&(a=t["$"+i]||a),r.push([1*e,1*i,a||"",l]))}},!0),t.data=r}function s(e,t){var n=e.$$("cells");t.sizes&&n.define("fixedRowHeight",!1);for(var o=0;o<t.data.length;o++){var r=t.data[o],i=r[0],a=r[1],s=r[2],l=r[3],u=n.getItem(i);u[a]=s,l&&(u.$cellCss=u.$cellCss||{},u.$cellCss[a]=l),e.callEvent("onCellChange",[i,a,s])}}function l(e,t,n,o,r){var i=t.$cellFormat?t.$cellFormat[r.id]:null;if(i){var a=e.formatHelpers[i];return a?a(o):o}return o}function u(e,t){var n=e.$$("cells"),o=n.getSelectArea();n.clearAll();for(var r=e.config.columnCount,i=e.config.rowCount,a=[{id:"rowId",header:"",width:40,css:"sheet_column_0",template:function(e,t,n,o,r){return e.id}}],s=1;r>=s;s++)a.push({id:s,editor:"text",header:{text:m.encode[s],css:e._hideColumn&&e._hideColumn.indexOf(s+1)>=0?"webix_ss_hideColumn":""},template:function(t,n,o,r){return l(e,t,n,o,r)}});n.refreshColumns(a),e._hideColumn&&e._hideColumn.length&&e._hideColumn.map(function(e){return n.hideColumn(e)});for(var u=[],s=1;i>=s;s++)u.push({id:s});n.parse(u),e._hideRow&&e._hideRow.length&&n.filter(function(t){if(-1===e._hideRow.indexOf(t.id))return!0;if(t.id-1===0){var n=e.$$("cells").getColumnConfig("rowId").header[0];n.css=(n.css||"")+" webix_ss_hideRow",e.$$("cells").refreshColumns()}else e.$$("cells").addCellCss(t.id-1,"rowId","webix_ss_hideRow");return!1}),o&&t.select&&o.end.row<i&&o.end.column<r&&n.addSelectArea(o.start,o.end)}function c(e,t,n,o){e.setCellValue(t,n,o),e.refresh()}t.__esModule=!0,t.init=r,t.reset=u;var f=n(12),d=o(f),h=n(15),v=o(h),p=n(16),w=o(p),g=n(14),m=o(g)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){function t(t,o,r){var i=e.getRow(t);i[o]=c(r,a),n(t,o)}function n(e,n){var r=o[e];if(r){var i=r[n];if(i)for(var a=0;a<i.length;a++){var s=i[a];s.row==e&&s.column==n||t(s.row,s.column,s.handler)}}}var o=[],r=[],a=f(e);e.attachEvent("onReset",function(e,t){o=[],r=[]}),e.attachEvent("onCellChange",function(t,u,f){var d=r[t];if(d&&d[u]&&s(o,r,u,t),f&&0===f.toString().indexOf("=")){var h=l(f),v=e.getRow(t);v[u]=c(h.handler,a),v["$"+u]=f,h.triggers.length&&i(o,r,h.triggers,{row:t,column:u,handler:h.handler})}n(t,u)})}function i(e,t,n,o){for(var r=[],i=0;i<n.length;i++)for(var s=n[i],l=s[0];l<=s[2];l++){var u=e[l];u||(u=e[l]=[]);for(var c=s[1];c<=s[3];c++){var f=u[c];f||(f=u[c]=[]),r.push([l,c]),f.push(o)}}a(t,o.row,o.column,r)}function a(e,t,n,o){var r=e[t];r||(r=e[t]=[]),r[n]=o}function s(e,t,n,o){var r=t[o][n];t[o][n]=null;for(var i=r.length-1;i>=0;i--)for(var a=r[i],s=e[a[0]][a[1]],l=s.length-1;l>=0;l--){var u=s[l];u.row==o&&u.column==n&&s.splice(l,1)}}function l(e){var t=[];return e=e.replace(/\((.*,.*)\)/g,"([$1])"),e=e.replace(/([A-Z]{1,2})([0-9]+)\:([A-Z]{1,2})([0-9]+)/gi,function(e,n,o,r,i){return n=p.decode[n.toUpperCase()],r=p.decode[r.toUpperCase()],t.push([1*o,n,1*i,r]),"this.r("+n+","+o+","+r+","+i+")"}),e=e.replace(/([A-Z]{1,2})([0-9]+)/gi,function(e,n,o){return n=p.decode[n.toUpperCase()],t.push([1*o,n,1*o,n]),"this.v("+n+","+o+")*1"}),e=e.replace(/[A-Z]+/g,function(e){return"this.m."+e}),e=e.replace("=","return "),{code:e,triggers:t,handler:u(e)}}function u(e){try{return new Function(e)}catch(t){}}function c(e,t){var n;try{n=e.call(t)}catch(o){return"ERROR"}return!n&&0!==n||isNaN(n)?"":Math.round(1e5*n)/1e5}function f(e){return{r:function(t,n,o,r){for(var i=[],a=n;r>=a;a++)for(var s=e.getRow(a),l=t;o>=l;l++)i.push(s[l]);return i},v:function(t,n){var o=e.getRow(n)[t];return o||0===o?1*o:""},m:h}}t.__esModule=!0,t.init=r;var d=n(13),h=o(d),v=n(14),p=o(v)},function(e,t){"use strict";function n(e){return!e&&0!==e||(e=1*e,isNaN(e))?!1:e}function o(e){for(var t=0,o=0;o<e.length;o++){var r=n(e[o]);r!==!1&&(t+=r)}return t}function r(e){for(var t=0,o=0,r=0;r<e.length;r++){var i=n(e[r]);i!==!1&&(t+=i,o++)}return t/o}function i(e){for(var t=0,o=0;o<e.length;o++){var r=n(e[o]);r!==!1&&t++}return t}function a(e){for(var t=0,n=0;n<e.length;n++)e[n]&&1*e[n]!==0&&t++;return t}function s(e){for(var t=0,n=0;n<e.length;n++)1*!e[n]&&t++;return t}function l(e){for(var t="",o=0;o<e.length;o++){var r=n(e[o]);r!==!1&&(r>t||""===t)&&(t=r)}return t||0}function u(e){for(var t="",o=0;o<e.length;o++){var r=n(e[o]);r!==!1&&(t>r||""===t)&&(t=r)}return t||0}function c(e){for(var t="",o=0;o<e.length;o++){var r=n(e[o]);r!==!1&&(t=""===t?r:t*r)}return t}function f(e){var t=e[0].length;for(var o in e)if(e[o].length!==t)return;for(var r=0,o=0;o<e[0].length;o++){var i="";for(var a in e){var s=n(e[a][o]);if(s===!1){i=0;break}i=""===i?s:i*s}webix.isUndefined(i)||(r+=i)}return r}function d(e){for(var t=0,o=0;o<e.length;o++){var r=n(e[o]);"number"==typeof r&&(t+=Math.pow(r,2))}return t}function h(e){for(var t=this.COUNT(e),o=this.AVERAGE(e),r=0,i=0;i<e.length;i++){var a=n(e[i]);a!==!1&&(r+=Math.pow(a-o,2))}return r/t}function v(e){return Math.sqrt(this.VARP(e))}function p(e,t){var o=n(e),r=n(t);return"number"==typeof o&&"number"==typeof r?Math.pow(o,r):void 0}function w(e,t){var o=n(e),r=n(t);return"number"==typeof o&&"number"==typeof r?o/r:void 0}function g(e){var t=n(e);return t!==!1&&t>=0?Math.sqrt(t):void 0}function m(e){var t=n(e);return t!==!1?Math.abs(t):void 0}function b(){return Math.random()}function _(){return Math.PI}function x(e){var t=n(e);return t!==!1?Math.round(t):void 0}function $(e,t){var o=n(e),r=n(t)||0;return o!==!1?parseFloat(o.toFixed(r)):void 0}function C(e,t){var o=n(e),r=n(t)||0;return o!==!1?Math.floor(o*Math.pow(10,r))/Math.pow(10,r):void 0}function y(e,t){var o=n(e),r=n(t)||0;return o!==!1?Math.ceil(o*Math.pow(10,r))/Math.pow(10,r):void 0}function S(e){var t=n(e);return t!==!1?parseInt(t):void 0}function V(e){var t=n(e);if(t!==!1){var o=Math.round(t);return o%2?o+1:o}}function E(e){var t=n(e);if(t!==!1){var o=Math.round(t);return o%2?o:o+1}}t.__esModule=!0,t.SUM=o,t.AVERAGE=r,t.COUNT=i,t.COUNTA=a,t.COUNTBLANK=s,t.MAX=l,t.MIN=u,t.PRODUCT=c,t.SUMPRODUCT=f,t.SUMSQ=d,t.VARP=h,t.STDEVP=v,t.POWER=p,t.QUOTIENT=w,t.SQRT=g,t.ABS=m,t.RAND=b,t.PI=_,t.INT=x,t.ROUND=$,t.ROUNDDOWN=C,t.ROUNDUP=y,t.TRUNC=S,t.EVEN=V,t.ODD=E},function(e,t){"use strict";t.__esModule=!0;
for(var n=t.decode={},o=t.encode={},r="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=1;1e3>i;i++){var a=parseInt((i-1)/r.length),s=(a?r[a-1]:"")+r[(i-1)%r.length];n[s]=i,o[i]=s}o[0]=o[1]},function(e,t){"use strict";function n(e,t){var n=e.$$("cells");n.attachEvent("onKeyPress",function(t,o){67===t&&o.ctrlKey&&n.getSelectedId()&&(a=r(e,n),s=document.getElementsByClassName("webix_clipbuffer")[0].value)}),t||n.attachEvent("onPaste",function(t){return o(e,n,t)}),e.attachEvent("onUndo",function(t,n,o,r,a){"paste"==t&&i(e,n,o,r,a)})}function o(e,t,n){var o=n===s?JSON.parse(a):webix.csv.parse(n,t.config.delimiter),r=t.mapSelection(null);if(r){var i=webix.uid();t.mapCells(r.row,r.column,o.length,null,function(r,a,l,u,c){if(o[u]&&o[u].length>c){var f=o[u][c],d=n===s,h=t.getItem(a)[l],v=d?f.text:f,p=d?e.getStyle(a,l):null,w=d?f.style:null;if(e.callEvent("onBeforePaste",[a,l,v,h,w,p,i]))return n===s&&(t.getItem(a)[l]=v,e.setStyle(a,l,w)),v}return r}),t.render()}}function r(e,t){var n=[];return t.mapSelection(function(t,o,r,i,a){return n[i]||(n[i]=[]),n[i].push({text:t,style:e.getStyle(o,r)}),t}),JSON.stringify(n)}function i(e,t,n,o,r){var i=e.$$("cells");i.getItem(t)[n]=o,e.setStyle(t,n,r),i.render()}t.__esModule=!0,t.init=n;var a,s},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){webix.ui({view:"contextmenu",id:"rows_context_menu",on:{onItemClick:function(t,n,o){var r=e.$$("cells").getSelectArea(),i=r.start,a=r.end;i&&a&&e.callEvent("onCommand",[this.getItem(t),i,a])},onBeforeShow:function(t,n,o){return"rowId"===n?!1:(this.clearAll(),"row"===o&&(i(n,e),this.parse(v)),void("column"===o&&(a(n,e),this.parse(p))))}}}),c.init(e),d.init(e)}function i(e,t){var n={row:e,column:1},o={row:e,column:t.config.columnCount};s(n,o,t)}function a(e,t){var n=t.$$("cells").data.order[0],o=t.$$("cells").data.order.length,r={row:n,column:e},i={row:o,column:e};s(r,i,t)}function s(e,t,n){n.$$("cells").addSelectArea(e,t)}t.__esModule=!0,t.init=r,t.selectRow=i,t.selectColumn=a;var l=n(14),u=(o(l),n(17)),c=o(u),f=n(19),d=o(f),h=webix.i18n.spreadsheet.menus,v=[{id:"add",group:"row",value:h.add_row},{id:"del",group:"row",value:h.del_row},{id:"show",group:"row",value:h.show_row},{id:"hide",group:"row",value:h.hide_row}],p=[{id:"add",group:"column",value:h.add_column},{id:"del",group:"column",value:h.del_column},{id:"show",group:"column",value:h.show_column},{id:"hide",group:"column",value:h.hide_column}]},function(e,t,n){(function(e){"use strict";function n(t){t.attachEvent("onCommand",function(n,o,r){"show"!=n.id&&"hide"!=n.id||e(n,o,r,t)}),o(t)}function o(e){e._hideColumn=[],e._hideRow=[]}function e(e,t,n,o){if("column"==e.group)switch(e.id){case"show":if(!o._hideColumn.length)return;for(var i=n.column;i>=t.column;){var a=r(o._hideColumn,i);if(a!==!1){var s=o.$$("cells").getColumnConfig(a-1||"rowId").header[0];s.css=s.css.replace("webix_ss_hideColumn",""),o.$$("cells").showColumn(a)}i--}break;case"hide":for(var l=n.column;l>=t.column;){o._hideColumn.push(l);var s=o.$$("cells").getColumnConfig(l-1||"rowId").header[0];s.css=(s.css||"")+" webix_ss_hideColumn",o.$$("cells").hideColumn(l),l--}}else if("row"==e.group)switch(e.id){case"show":if(!o._hideRow.length)return;for(var u=n.row;u>=t.row;){var c=r(o._hideRow,u);if(c!==!1)if(c-1===0){var s=o.$$("cells").getColumnConfig("rowId").header[0];s.css=s.css.replace("webix_ss_hideRow",""),o.$$("cells").refreshColumns()}else o.$$("cells").removeCellCss(c-1,"rowId","webix_ss_hideRow");u--}o.$$("cells").filter(function(e){return-1===o._hideRow.indexOf(e.id)});break;case"hide":for(var f=n.row;f>=t.row;f--)if(o._hideRow.push(f),f-1===0){var s=o.$$("cells").getColumnConfig("rowId").header[0];s.css=(s.css||"")+" webix_ss_hideRow",o.$$("cells").refreshColumns()}else o.$$("cells").addCellCss(f-1,"rowId","webix_ss_hideRow");o.$$("cells").filter(function(e){return-1===o._hideRow.indexOf(e.id)})}}function r(e,t){var n=e.indexOf(t+1),o=e.indexOf(t-1);return n>=0?e.splice(n,1)[0]:o>=0?e.splice(o,1)[0]:!1}t.__esModule=!0,t.init=n,t.process=e}).call(t,n(18))},function(e,t){function n(){u=!1,a.length?l=a.concat(l):c=-1,l.length&&o()}function o(){if(!u){var e=setTimeout(n);u=!0;for(var t=l.length;t;){for(a=l,l=[];++c<t;)a&&a[c].run();c=-1,t=l.length}a=null,u=!1,clearTimeout(e)}}function r(e,t){this.fun=e,this.array=t}function i(){}var a,s=e.exports={},l=[],u=!1,c=-1;s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new r(e,t)),1!==l.length||u||setTimeout(o,0)},r.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=i,s.addListener=i,s.once=i,s.off=i,s.removeListener=i,s.removeAllListeners=i,s.emit=i,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t,n){(function(e){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(t){t.attachEvent("onCommand",function(n,o,r){"add"!=n.id&&"del"!=n.id||e(n,o,r,t)})}function e(e,t,n,o){var r=o.serialize({math:!0}),i=r.data,s=i.length;if("column"==e.group)switch(e.id){case"add":for(o.config.columnCount+=1,o.reset({select:!0});s--;)i[s][1]>=t.column&&(i[s][1]+=1);break;case"del":for(o.config.columnCount-=n.column-t.column+1,o.reset({select:!0});s--;)i[s][1]>=t.column&&i[s][1]<=n.column?i.splice(s,1):i[s][1]>n.column&&(i[s][1]-=1)}else if("row"==e.group)switch(e.id){case"add":for(o.config.rowCount+=1,o.reset({select:!0});s--;)i[s][0]>=t.row&&(i[s][0]+=1);break;case"del":for(o.config.rowCount-=n.row-t.row+1,o.reset({select:!0});s--;)i[s][0]>=t.row&&i[s][0]<=n.row?i.splice(s,1):i[s][0]>n.row&&(i[s][0]-=1)}var l=a.get(e.group,e.id);for(s=r.data.length;s--;)i[s][2]&&"string"==typeof i[s][2]&&"="==i[s][2].substr(0,1)&&(i[s][2]=l(i[s][2],t,n));r.data=i,o.parse(r)}t.__esModule=!0,t.init=r,t.process=e;var i=n(20),a=o(i)}).call(t,n(18))},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(){}function i(){}function a(e,t){for(var n=(0,u.split)(e),o=n.length,r=1;o>r;r+=2){var i=n[r],a=i[0],s=i[1];"move"===t.id?(s+=t.column,a+=t.row):"row"===t.id&&t.row<=a?a+=t.count:"column"===t.id&&t.column<=s&&(s+=t.count),s&&a?n[r]=l.encode[s]+a:n[r]=0}return n.join("")}t.__esModule=!0,t.updateRanges=r,t.update=i,t.updateMath=a;var s=n(14),l=o(s),u=n(21)},function(e,t){"use strict";function n(e){var t=e.charCodeAt(0);return t>=65&&122>=t}function o(e){var t=e.charCodeAt(0);return t>=48&&57>=t}function r(e,t){for(var r=e.length,i=t+1;r>i;i++){var a=e[i];if(!n(a)&&!o(a))return e.substr(t,i-t)}return e.substr(t)}function i(e){return v.test(e)}function a(e){var t,n=o(e[1])?1:2,r=e.substr(0,n),i=e.substr(n);return t=2==r.length?28*(r.charCodeAt(0)-64)+r.charCodeAt(1)-64:r.charCodeAt(0)-64,[1*i,t]}function s(e,t){var n=a(t),o=n[0],r=n[1];return e.push([o,r,o,r]),"this.v("+o+","+r+")"}function l(e){return"this.m."+e}function u(e){return"this.g."+e+"()"}function c(e){return"this.p."+e}function f(e,t,n){var o=a(t),r=o[0],i=o[1],s=a(n),l=s[0],u=s[1];if(r>l){var c=r;r=l,l=c}if(i>u){var c=i;i=u,u=c}return e.push([r,i,l,u]),"this.r("+r+","+i+","+l+","+u+")"}function d(e){for(var t=[],o=0,s=!1,l=!1,u=1;u<e.length;u++){var c=e[u];if('"'==c)s=!s;else if(!s)if("{"==c&&"{"==e[u+1])l=!0;else if("}"==c&&"}"==e[u+1])l=!1;else if(!l&&n(c)){var f=r(e,u).toUpperCase(),d=u+f.length-1;"("!==e[d+1]&&i(f)&&(0!==u&&t.push(e.substr(o,u-o)),t.push(a(f)),o=d+1),u=d}}return o!=e.length&&t.push(e.substr(o)),t}function h(e){var t="return ",o=[],a=!1,d="";if("="!==e[0])return!1;for(var h=1;h<e.length;h++){var v=e[h];if('"'==v)a=!a;else{if("{"==v&&"{"==e[h+1]){var p=r(e,h+2);h+=p.length+3,t+=c(p);continue}if(!a&&n(v)){var p=r(e,h).toUpperCase();h+=p.length-1,"("===e[h+1]?t+=l(p):i(p)?":"===e[h+1]?(d=p,h++):""!==d?(t+=f(o,d,p),d=""):t+=s(o,p):t+=u(p);continue}}t+=e[h]}return{code:t+";",triggers:o}}t.__esModule=!0,t.split=d,t.parse=h;var v=/[A-Z]{1,2}[0-9]+/},function(e,t){"use strict";function n(e){var t=e.$$("cells");webix.UIManager.addHotKey("delete",function(){e.eachSelectedCell(function(t){return e.setCellValue(t.row,t.column,"")}),e.refresh()},t),webix.UIManager.addHotKey("any",function(e,n){if(16!=(n.which||n.keyCode)){var o=e.getSelectedId(!0);o.length&&t.config.editable&&t.edit(o[0])}},t),webix.UIManager.addHotKey("ctrl-z",function(){return e.undo()},t),webix.UIManager.addHotKey("ctrl-y",function(){return e.redo()},t)}t.__esModule=!0,t.init=n},function(e,t){"use strict";function n(e){if(e.config.resizeCell){var t=e.$$("cells");t.define("resizeRow",!0),t.define("resizeColumn",!0),t.define("fixedRowHeight",!1),t.attachEvent("onRowResize",function(t){e.$$("cells").removeSelectArea(),e._save("sizes",{row:t,column:0,size:e.getRow(t).$height})}),t.attachEvent("onColumnResize",function(t){e.$$("cells").removeSelectArea(),e._save("sizes",{row:0,column:t,size:e.getColumn(t).width})}),e.attachEvent("onUndo",function(t,n,r,i){"c-resize"!=t&&"r-resize"!=t||o(e,n,r,i)})}e.attachEvent("onDataParse",function(t){if(t.sizes){for(var n=0;n<t.sizes.length;n++){var o=t.sizes[n];1*o[0]!==0?e.getRow(o[0]).$height=1*o[2]:e.getColumn(o[1]).width=1*o[2]}t.sizes.length&&e.refresh(!0)}}),e.attachEvent("onDataSerialize",function(t){for(var n=[],o=e.$$("cells"),r=o.config.columns,i=o.data.order,a=o.config.columnWidth,s=o.config.rowHeight,l=1;l<r.length;l++){var u=r[l].width;u&&u!=a&&n.push([0,l,u])}for(var l=0;l<i.length;l++){var c=o.getItem(i[l]).$height;c&&c!=s&&n.push([1*i[l],0,c])}t.sizes=n})}function o(e,t,n,o){t?(e.$$("cells").getItem(t).$height=o,e.refresh(),e._save("sizes",{row:t,column:0,size:o})):e._table.setColumnWidth(n,o),e.$$("cells")._renderSelectAreas()}t.__esModule=!0,t.init=n},function(e,t){"use strict";function n(e){e.attachEvent("onStyleChange",function(t,n,r){var i=o(e,t,n);i&&(i[3]=r.id)}),e.attachEvent("onCellChange",function(t,n,r){var i=o(e,t,n);i&&(i[2]=r)}),e.attachEvent("onDataParse",function(t){if(t.spans)for(var n=0;n<t.spans.length;n++){var o=t.spans[n];r(e,{row:o[0],column:o[1]},1*o[2],1*o[3])}}),e.attachEvent("onDataSerialize",function(t){var n=[],o=e.$$("cells").getSpan();if(o){for(var r in o){var i=o[r];for(var a in i){var s=i[a];n.push([1*r,1*a,s[0],s[1]])}}t.spans=n}}),e.attachEvent("onUndo",function(t,n,o,r,i){"span"!=t&&"split"!=t||("span"==t&&(i=!i),s(e,n,o,r,i))})}function o(e,t,n){var o=e.$$("cells").getSpan()[t];return o?o[n]:void 0}function r(e,t,n,o){if(!(2>n&&2>o)){var r=e.getRow(t.row),i=r[t.column],a=r.$cellCss?r.$cellCss[t.column]||"":"";e.$$("cells").addSpan(t.row,t.column,n,o,i,a),e._save("spans",{row:t.row,column:t.column,x:n,y:o})}}function i(e,t){e.$$("cells").removeSpan(t.row,t.column),e._save("spans",{row:t.row,column:t.column,x:0,y:0})}function a(e){var t,n,o,r;o=r=0,t=n=1/0;for(var i=0;i<e.length;i++){var a=1*e[i].column,s=1*e[i].row;t=Math.min(a,t),o=Math.max(a,o),n=Math.min(s,n),r=Math.max(s,r)}return{cell:{row:n,column:t},x:o-t+1,y:r-n+1}}function s(e,t,n,o,a){a?i(e,{row:t,column:n}):r(e,{row:t,column:n},o[0],o[1]),e.refresh()}t.__esModule=!0,t.init=n,t.addSpan=r,t.removeSpan=i,t.getRange=a},function(e,t){"use strict";function n(e){i(e),e.attachEvent("onReset",function(){return i(e)}),e.attachEvent("onBeforeStyleChange",function(t,n,o,r,i){return a(e,{action:"style",row:t,column:n,value:r,newValue:o,group:i})}),e.attachEvent("onBeforeValueChange",function(t,n,o,r){return a(e,{action:"value",row:t,column:n,value:r,newValue:o})}),e.attachEvent("onBeforeSpan",function(t,n,o){return a(e,{action:"span",row:t,column:n,value:o,newValue:o})}),e.attachEvent("onBeforeSplit",function(t,n,o,r){return a(e,{action:"split",row:t,column:n,value:o,newValue:o,group:r})}),e.$$("cells").attachEvent("onColumnResize",function(t,n,o){return a(e,{action:"c-resize",row:0,column:t,value:o,newValue:n})}),e.$$("cells").attachEvent("onRowResize",function(t,n,o){return a(e,{action:"r-resize",row:t,column:0,value:o,newValue:n})}),e.attachEvent("onBeforePaste",function(t,n,o,r,i,s,l){return a(e,{action:"paste",row:t,column:n,value:r,newValue:o,style:s,newStyle:i,group:l})})}function o(e){l(e,-1)}function r(e){l(e,1)}function i(e){e._ssUndoHistory=[],e._ssUndoCursor=-1}function a(e,t){e.$skipHistory||(e._ssUndoHistory.splice(e._ssUndoCursor+1),e._ssUndoHistory.push(t),e._ssUndoCursor++)}function s(e,t){t.$skipHistory=!0,e(),t.$skipHistory=!1}function l(e,t){var n=e._ssUndoHistory[t>0?e._ssUndoCursor+t:e._ssUndoCursor];if(n){var o=t>0?n.newValue:n.value,r=t>0,i=[n.action,n.row,n.column,o,r];"paste"==n.action&&i.push(r?n.newStyle:n.style),s(function(){e.callEvent("onUndo",i)},e),e._ssUndoCursor+=t;var a=n.group,u=e._ssUndoHistory[t>0?e._ssUndoCursor+t:e._ssUndoCursor];u&&a&&a==u.group&&l(e,t)}}t.__esModule=!0,t.init=n,t.undo=o,t.redo=r},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e.attachEvent("onComponentInit",function(){return i(e)}),{view:"toolbar",css:"webix_ssheet_toolbar",elements:[{view:"label",template:"Edit: ",width:60},{view:"live-editor",disabled:!0,id:"liveEditor",suggestData:l,linkToView:e.config.id}]}}function i(e){var t=!1,n=null;e.$$("cells").attachEvent("onBeforeEditStart",function(){return e.$$("liveEditor").focus(),!1}),e.$$("cells").attachEvent("onBeforeBlockSelect",function(n){return e.$$("liveEditor")!==webix.UIManager.getFocus()?!0:void(t=!0)}),e.attachEvent("onAfterSelect",function(o){if(!t){var r=e.$$("liveEditor");n=e.$$("cells").getSelectArea(),r.config.selectCell=n;var i=e.getCellValue(o[0].row,o[0].column);r.setValue(i||""),r.enable()}}),webix.event(e.$$("cells").$view,"click",function(t){if(e.$$("liveEditor")!==webix.UIManager.getFocus())return!0;var n=e.$$("liveEditor").getValue().trim(),o=(n.substr(0,1),n.substr(n.length-1,1)),r=e.$$("cells");if(o.match(/[\+\-\/\*\%\=\(:]/)){var i=r.locate(t);if(i&&!i.header&&"rowId"!==i.column){var a=e.getColumn(i.column).header[0].text+i.row;return e.$$("liveEditor").setRange(a),webix.html.preventEvent(t)}}else{var s=r.getSelectArea();e.setCellValue(s.start.row,s.start.column,n),r.refresh(s.start.row)}},this,!0),e.$$("cells").attachEvent("onBeforeAreaRemove",function(t){return e.$$("liveEditor")!==webix.UIManager.getFocus()?!0:t===n.name.toString()?!1:void 0}),e.$$("cells").attachEvent("onAfterAreaAdd",function(t,o){if(e.$$("liveEditor")!==webix.UIManager.getFocus())return!0;var r=e.$$("cells").getAllSelectAreas();for(var i in r)n&&i===n.name.toString()||e.$$("cells").removeSelectArea(i);return!1}),e.$$("cells").attachEvent("onAfterBlockSelect",function(n,o){if(!t)return!0;t=!1;var r=e.getColumn(n.column).header[0].text+n.row,i=e.getColumn(o.column).header[0].text+o.row;r==i?e.$$("liveEditor").setRange(r):e.$$("liveEditor").setRange(r+":"+i)})}t.__esModule=!0,t.init=r,n(27);var a=n(13),s=o(a),l=Object.keys(s);l.splice(l.indexOf("__esModule"),1)},function(e,t,n){"use strict";n(28),webix.protoUI({name:"live-editor",$cssName:"text webix_ssheet_formula",defaults:{keyPressTimeout:25,selectCell:null},$init:function(e){var t=this;e.suggest={view:"suggest-formula",data:e.suggestData},this.attachEvent("onKeyPress",function(e,n){13===e&&new Date-(t._last_value_set||0)>300&&(t.updateCellValue(),webix.UIManager.setFocus(t.getTopParentView().$$("cells")))})},updateCellValue:function(){var e=this.getValue();if(this.config.selectCell){var t=webix.$$(this.config.linkToView);t.setCellValue(this.config.selectCell.start.row,this.config.selectCell.start.column,e),t.refresh()}else this.setValue("")},setValueHere:function(e){this._last_value_set=new Date;var t=this.getInputNode(),n=t.value,o=t.selectionStart,r=n.substring(0,o),i=n.substring(o);r=r.replace(/([a-zA-Z]+)$/,e),t.value=r+"("+i,t.setSelectionRange(r.length+1,r.length+1)},setRange:function(e){var t=this.getInputNode(),n=t.selectionStart,o=this.getValue(),r=o.substring(0,n)+e,i=o.substring(n);t.value=r+i,t.setSelectionRange(r.length+1,r.length+1),this.focus()}},webix.ui.text)},function(e,t){"use strict";webix.protoUI({name:"suggest-formula",defaults:{fitMaster:!1,width:200,filter:function(e,t){var n=webix.$$(this.config.master).getInputNode(),o=n.selectionStart,r=n.value;if("="===r.charAt(0)){var i=r.substring(0,o).match(/([a-zA-Z]+)$/),a=r.charAt(o).search(/[^A-Za-z0-9]/);return!i||o!==r.length&&0!==a||(t=i[0]),0===e.value.toString().toLowerCase().indexOf(t.toLowerCase())}}},$init:function(){var e=this;this.attachEvent("onBeforeShow",function(t,n,o){if(t.tagName){var r=webix.html.offset(t),i=9,a=r.y+r.height,s=r.x+t.selectionStart*i;return webix.ui.popup.prototype.show.apply(e,[{x:s,y:a}]),!1}})},setMasterValue:function(e,t){var n=e.id?this.getItemText(e.id):e.text||e.value,o=webix.$$(this.config.master);o.setValueHere(n),t||this.hide(!0),this.callEvent("onValueSuggest",[e,n])}},webix.ui.suggest)},function(e,t){"use strict"}]);
//# sourceMappingURL=spreadsheet.js.map
